# jndi注入

jndi 是什么

jndi （the java Naming and Directory insterface ，java 命名和目录接口）

是一组在java 应用中访问命名和目录服务器的API,命令服务将名称和**对象**联系起来，使得我们可以用名称访问对象。程序员在程序中引用的对象是动态的，不是硬编码在程序中的，比如数据库的地址密码登随着业务的变化而变化

jndi 对象主要有

- RMI（java 远程方法调用）
- LDAP（轻量目录访问协议）
- CORBA(公共对象请求代理体系结构)
- NDS（域名服务）这种payload可以用来探测

|          | JDK6      | JDK7      | JDK8      | JDK11      |  |
| -------- | --------- | --------- | --------- | ---------- | - |
| rmi可用  | 6u132以下 | 7u122以下 | 8u113以下 | 无         |  |
| LDAP可用 | 6u211以下 | 7u201以下 | 8u191以下 | 11.0.1以下 |  |

log4j 本质三上是用了jndi的注入漏洞

fastjson 有很多利用方式，其中一种也是jndi的利用方式

漏洞端：使用了lookup寒暑表，并且参数可控

- 类名要和ldap服务的转发名一样
- static 静态代码块执行顺序  1、static代码块（最高优先级） 2、static关键之修饰的  3、函数构造
- 包名实际上是不需要的
- 注意编译当前类的java版本

## 基于RMI的注入

## 基于LDAP的注入

## 基于DNS的手段
