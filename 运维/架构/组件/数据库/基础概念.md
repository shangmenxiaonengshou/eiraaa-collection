数据库基础知识

关系形数据库： 数据以结构存储，结构表示数据之间的关系 如库、表、列的结构

非关系形数据库



关系形数据库： B+树是一种数据结构，应对读多写少的问题，LsM-tree 不是一种数据结构而是数据在系统上的组织方式，主要应对写多读少的情况

追加写日志为什么快：是顺序io，磁盘效率高  内存顺序io (100ns)>>内存随机io≈磁盘顺序io>>磁盘随机io 10(ms)

B+tree：

- 节点大小(16k)对应 磁盘页的倍数(4k)
- 就地写 改数据的时候需要根据数据结构找到对应的页进行修改,就地写的范围中是不会有数据冲突/重复的
- 查找数据使用二分查找
- 离散写的时候需要分页，会造成磁盘利用率很低，只有大约50% (空间放大)

LSB-tree:  Log Strutrue Merge tree  主体思想是顺序io

追加写，不管是否之前数据存在都追加写，会造成数据冗余

- 数据冗余会造成查询比较麻烦，所以要排序为有序数据，以块为单位查找
- 数据冗余 需要合并压缩去除旧版本的数据，又不能大面积阻塞服务，需要将数据块拆分为小块在内存中写达到阈值之后然后dump到磁盘，内存中可以用就地写，写入内存前先追加写wal(预写日志)，防止内存数据丢失
- 按冷热数据进行分层
- 在 同一个SSTable 中的数据不会有重复，L1-ln 中每一层数据没有重复，层与层之间有数据冗余

rocksdb磁盘上是顺序写，磁盘使用率 比innodb 磁盘使用率要高



分库分表

分库：多是物理资源划分，多个实例

分表： 多是逻辑划分，冷热数据分离
